/* -----------------------------------*\
  #TESTIMONIALS
\*-----------------------------------*/

.testimonials {
  margin-bottom: 30px;
  position: relative;
}

.testimonials-title {
  margin-bottom: 20px;
}

/* --- List Container (Horizontal Scroll) --- */
.testimonials-list {
  display: flex;
  justify-content: flex-start;
  gap: 20px;
  /* CRITICAL: Large padding allows the floating avatar to hang outside */
  padding: 40px 20px 40px 30px; 
  overflow-x: auto;
  scroll-behavior: smooth;
  scroll-snap-type: x mandatory;
}

/* Scrollbar Styling */
.testimonials-list::-webkit-scrollbar { display: none; }
.testimonials-list.has-scrollbar::-webkit-scrollbar { height: 8px; }
.testimonials-list.has-scrollbar::-webkit-scrollbar-track { background: rgba(255,255,255,0.06); border-radius: 8px; }
.testimonials-list.has-scrollbar::-webkit-scrollbar-thumb { background: #FFD369; border-radius: 8px; }

.testimonials-item {
  flex: 0 0 280px;
  max-width: 280px;
  scroll-snap-align: start;
}

/* --- The Main Card Style --- */
.testimonial-card {
  position: relative;
  /* Slightly darker top (#242424) to match the avatar box better */
  background: linear-gradient(180deg, #242424 0%, #1c1c1c 100%);
  border: 1px solid #383838;
  border-radius: 14px;
  /* Top padding prevents text from hitting the avatar area */
  padding: 30px 20px 25px 20px;
  box-shadow: 0 16px 30px rgba(0,0,0,0.2); 
  overflow: visible !important; /* CRITICAL: Allows avatar to hang outside */
  margin-top: 15px;
  transition: transform .25s ease;
  cursor: pointer;
}

.testimonial-card:hover {
  transform: translateY(-2px);
  border-color: #555;
}

/* --- The Floating Avatar Box --- */
.testimonials-avatar-box {
  position: absolute;
  top: -25px;
  left: -25px;
  width: 80px;
  height: 80px;
  border-radius: 20px;
  /* The Dark Stealth Gradient */
  background: linear-gradient(135deg, #2A2A2A 0%, #161616 100%);
  border: 1px solid rgba(255,255,255,0.05);
  box-shadow: 6px 6px 15px rgba(0,0,0,0.6);
  z-index: 10;
  display: flex;
  justify-content: center;
  align-items: center;
  animation: floatHead 4s ease-in-out infinite;
}

/* The Avatar Image */
.testimonials-avatar-box img {
  /* FIXED: Set to 68px to fill the box perfectly */
  width: 68px !important;
  height: 68px !important;
  border-radius: 16px;
  object-fit: cover;
  display: block;
  background-color: #333; 
}

/* --- Text & Layout --- */

/* Title: Pushed right to sit NEXT to the avatar */
.testimonials-item-title {
  margin-left: 65px; 
  margin-bottom: 12px;
  color: #fff;
  font-size: 1rem;
  font-weight: 700;
  line-height: 1.3;
}

/* Review Text */
.testimonials-text {
  position: relative;
  max-height: 80px; 
  overflow: hidden;
}

/* The Fade Effect at bottom of text */
.testimonials-text::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  /* FIXED: Set to 35px (removed the conflicting 50px rule) */
  height: 35px;
  /* Rounded corners to match card */
  border-radius: 0 0 14px 14px;
  /* Smooth transparent-to-card-color gradient */
  background: linear-gradient(to bottom, rgba(28,28,28,0) 0%, #1c1c1c 100%);
  pointer-events: none;
}

.testimonials-text p {
  color: #d6d6d6;
  font-size: 0.95rem;
  font-weight: 300;
  line-height: 1.6;
}

/* --- Animations --- */
@keyframes floatHead {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-6px); } 
}

/* --- Navigation Buttons --- */
.testimonial-nav { 
  position: absolute; 
  top: 50%; 
  transform: translateY(-50%); 
  width: 40px; 
  height: 40px; 
  display: flex; 
  align-items: center; 
  justify-content: center; 
  border-radius: 50%; 
  background: rgba(32,32,32,0.8); 
  backdrop-filter: blur(4px); 
  color: #fff; 
  cursor: pointer; 
  z-index: 20; 
  border: 1px solid #444;
}
.testimonial-nav:hover { background: #FFD369; color: #000; }
.testimonial-nav.prev { left: -10px; display: none; } 
.testimonial-nav.next { right: -10px; display: none; }

/* --- MODAL (Expanded View) --- */
.modal-container { position: fixed; inset: 0; display: flex; justify-content: center; align-items: center; z-index: 9999; pointer-events: none; visibility: hidden; }
.modal-container.active { pointer-events: all; visibility: visible; }
.overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.85); opacity: 0; visibility: hidden; transition: 0.3s; backdrop-filter: blur(2px); }
.overlay.active { opacity: 1; visibility: visible; }
.testimonials-modal { background: #1c1c1c; padding: 25px; border: 1px solid #333; border-radius: 14px; width: 90%; max-width: 600px; transform: scale(0.9); opacity: 0; transition: 0.3s; z-index: 10000; box-shadow: 0 10px 40px rgba(0,0,0,0.5); }
.modal-container.active .testimonials-modal { transform: scale(1); opacity: 1; }
.modal-close-btn { position: absolute; top: 15px; right: 15px; background: #2a2a2a; color: #fff; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; border-radius: 8px; cursor: pointer; }
.modal-avatar-box { width: 60px; height: 60px; border-radius: 14px; overflow: hidden; margin-bottom: 15px; }
.modal-avatar-box img { width: 100%; height: 100%; object-fit: cover; }
.modal-title { color: #fff; margin-bottom: 10px; font-size: 1.2rem; }
.modal-content p { color: #ccc; line-height: 1.6; }

/* Expanded centered testimonial (overlay + card) */
/* Expanded centered testimonial (overlay + card) */
.expanded-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.55);
  z-index: 9998;
  opacity: 0;
  transition: opacity .22s ease;
  backdrop-filter: blur(2px);
}
.expanded-overlay.visible { opacity: 1; }

.expanded-testimonial {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%,-50%) scale(.98);
  width: min(92%, 760px);
  max-width: 760px;
  max-height: 90vh;
  overflow: auto;
  z-index: 9999;
  background: var(--eerie-black-2, #1c1c1c);
  border: 1px solid var(--jet, #333);
  border-radius: 14px;
  padding: 22px;
  box-shadow: 0 8px 24px rgba(0,0,0,0.3);
  opacity: 0;
  transition: transform .22s ease, opacity .22s ease;
}
.expanded-testimonial.visible {
  transform: translate(-50%,-50%) scale(1);
  opacity: 1;
}

/* Close button */
.expanded-close {
  position: absolute;
  top: 12px;
  right: 12px;
  background: var(--onyx, #2a2a2a);
  color: var(--white-2, #fff);
  border-radius: 8px;
  width: 36px;
  height: 36px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
  z-index: 2;
  cursor: pointer;
  border: 0;
}

/* Layout inside modal */
.expanded-inner .expanded-header {
  display: flex;
  gap: 14px;
  align-items: center;
  margin-bottom: 12px;
}
.expanded-avatar-box img {
  width: 72px;
  height: 72px;
  object-fit: cover;
  border-radius: 12px;
}
.expanded-title {
  color: var(--white-2, #fff);
  margin: 0;
}
.expanded-body {
  color: var(--light-gray, #ccc);
  font-size: 0.95rem;
  line-height: 1.6;
}
.expanded-body .testimonials-text,
.expanded-body [data-testimonials-text] {
  display: block !important;
  -webkit-line-clamp: unset !important;
  line-clamp: unset !important;
  overflow: visible !important;
  white-space: normal !important;
}
